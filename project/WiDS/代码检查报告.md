# WiDS é¡¹ç›®ä»£ç æ£€æŸ¥æŠ¥å‘Š

## æ£€æŸ¥æ—¥æœŸ
2026å¹´1æœˆ

## æ£€æŸ¥èŒƒå›´
- `app.py` (3625è¡Œ)
- `feature_engineering.py` (305è¡Œ)
- `model_utils.py` (91è¡Œ)
- `requirements.txt`
- `README.md`
- `run_app.sh` å’Œ `run_app.bat`

---

## âœ… ä¼˜ç‚¹

### 1. ä»£ç ç»“æž„è‰¯å¥½
- æ¨¡å—åŒ–è®¾è®¡æ¸…æ™°ï¼ŒåŠŸèƒ½åˆ†ç¦»æ˜Žç¡®
- ä½¿ç”¨äº† Streamlit çš„ç¼“å­˜æœºåˆ¶ï¼ˆ`@st.cache_data` å’Œ `@st.cache_resource`ï¼‰ä¼˜åŒ–æ€§èƒ½
- è·¯å¾„ç®¡ç†ä½¿ç”¨ `pathlib.Path`ï¼Œè·¨å¹³å°å…¼å®¹æ€§å¥½

### 2. é”™è¯¯å¤„ç†å®Œå–„
- å¤§éƒ¨åˆ†å…³é”®æ“ä½œéƒ½æœ‰ try-except ä¿æŠ¤
- å¯¹æ–‡ä»¶ä¸å­˜åœ¨çš„æƒ…å†µæœ‰é€‚å½“çš„è­¦å‘Šæç¤º
- å¯¹å¯¼å…¥å¤±è´¥æœ‰é™çº§å¤„ç†ï¼ˆç®€åŒ–ç‰ˆæœ¬ï¼‰

### 3. æ€§èƒ½ä¼˜åŒ–
- ä½¿ç”¨åˆ†å—è¯»å–å¤§æ•°æ®æ–‡ä»¶ï¼ˆ`chunksize`ï¼‰
- é™åˆ¶æ ·æœ¬æ•°é‡å‡å°‘å†…å­˜å ç”¨ï¼ˆ`max_rows=10000`ï¼‰
- ä½¿ç”¨ Streamlit ç¼“å­˜å‡å°‘é‡å¤è®¡ç®—

### 4. ç”¨æˆ·ä½“éªŒ
- æä¾›äº†è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯
- æœ‰å‹å¥½çš„é”™è¯¯æç¤ºå’Œè­¦å‘Šä¿¡æ¯
- ç•Œé¢è®¾è®¡ç¾Žè§‚ï¼Œä½¿ç”¨äº†è‡ªå®šä¹‰ CSS æ ·å¼

---

## âš ï¸ å‘çŽ°çš„é—®é¢˜

### ðŸ”´ ä¸¥é‡é—®é¢˜

#### 1. æ¨¡å—å¯¼å…¥é”™è¯¯
**ä½ç½®**: `app.py` ç¬¬ 448 è¡Œ

**é—®é¢˜**:
```python
from model_training import prepare_features
```

**åˆ†æž**: 
- `prepare_features` å‡½æ•°å®žé™…å®šä¹‰åœ¨ `model_utils.py` ä¸­ï¼Œè€Œä¸æ˜¯ `model_training` æ¨¡å—
- è¿™ä¼šå¯¼è‡´ `ImportError`ï¼Œä»£ç ä¼šé™çº§åˆ°ç®€åŒ–ç‰ˆæœ¬ï¼Œä½†è¿™ä¸æ˜¯é¢„æœŸè¡Œä¸º

**å»ºè®®ä¿®å¤**:
```python
# æ–¹æ¡ˆ1ï¼šä»Ž model_utils å¯¼å…¥
from model_utils import prepare_features

# æ–¹æ¡ˆ2ï¼šæˆ–è€…ç›´æŽ¥ä½¿ç”¨ model_utils ä¸­çš„å‡½æ•°
import model_utils
X_prepared, _, _, _ = model_utils.prepare_features(...)
```

#### 2. è·¯å¾„ä¾èµ–ä¸ä¸€è‡´
**ä½ç½®**: `app.py` ç¬¬ 127, 431 è¡Œ

**é—®é¢˜**:
```python
sys.path.insert(0, str(BASE_DIR.parent))
from feature_engineering import apply_feature_engineering
```

**åˆ†æž**:
- `BASE_DIR` æ˜¯ `app.py` æ‰€åœ¨ç›®å½•ï¼ˆ`project/WiDS/`ï¼‰
- `BASE_DIR.parent` æ˜¯ `project/` ç›®å½•
- ä½† `feature_engineering.py` å®žé™…åœ¨ `project/WiDS/` ç›®å½•ä¸‹ï¼Œä¸Ž `app.py` åŒçº§
- åº”è¯¥ä½¿ç”¨ `BASE_DIR` è€Œä¸æ˜¯ `BASE_DIR.parent`

**å»ºè®®ä¿®å¤**:
```python
# æ–¹æ¡ˆ1ï¼šç›´æŽ¥å¯¼å…¥ï¼ˆå¦‚æžœ feature_engineering.py åœ¨åŒä¸€ç›®å½•ï¼‰
from feature_engineering import apply_feature_engineering

# æ–¹æ¡ˆ2ï¼šå¦‚æžœéœ€è¦æ·»åŠ è·¯å¾„ï¼Œåº”è¯¥æ·»åŠ å½“å‰ç›®å½•
sys.path.insert(0, str(BASE_DIR))
from feature_engineering import apply_feature_engineering
```

---

### ðŸŸ¡ ä¸­ç­‰é—®é¢˜

#### 3. è£¸éœ²çš„ except è¯­å¥
**ä½ç½®**: `app.py` ç¬¬ 509, 605 è¡Œ

**é—®é¢˜**:
```python
except:
    pass
```

**åˆ†æž**:
- ä½¿ç”¨è£¸éœ²çš„ `except:` ä¼šæ•èŽ·æ‰€æœ‰å¼‚å¸¸ï¼ŒåŒ…æ‹¬ `KeyboardInterrupt` å’Œ `SystemExit`
- è¿™ä¸æ˜¯æœ€ä½³å®žè·µï¼Œåº”è¯¥æ˜Žç¡®æ•èŽ·çš„å¼‚å¸¸ç±»åž‹

**å»ºè®®ä¿®å¤**:
```python
except Exception:
    pass
# æˆ–è€…æ›´å…·ä½“
except (AttributeError, TypeError):
    pass
```

#### 4. ä»£ç é‡å¤
**ä½ç½®**: `app.py` ç¬¬ 427-627 è¡Œ

**é—®é¢˜**:
- é¢„æµ‹åŠŸèƒ½ä¸­æœ‰ä¸¤å¥—å‡ ä¹Žç›¸åŒçš„ä»£ç é€»è¾‘ï¼ˆå®Œæ•´ç‰ˆæœ¬å’Œç®€åŒ–ç‰ˆæœ¬ï¼‰
- ä»£ç é‡å¤çº¦ 200 è¡Œï¼Œç»´æŠ¤å›°éš¾

**å»ºè®®**:
- æå–å…¬å…±é€»è¾‘åˆ°ç‹¬ç«‹å‡½æ•°
- ä½¿ç”¨ç­–ç•¥æ¨¡å¼æˆ–å·¥åŽ‚æ¨¡å¼å¤„ç†ä¸åŒçš„é¢„å¤„ç†æµç¨‹

#### 5. ç¡¬ç¼–ç çš„æ ·æœ¬æ•°é‡
**ä½ç½®**: å¤šå¤„ä½¿ç”¨ `nrows=5000`, `nrows=10000`, `sample_size=5000`

**é—®é¢˜**:
- æ ·æœ¬æ•°é‡ç¡¬ç¼–ç åœ¨å¤šä¸ªåœ°æ–¹
- éš¾ä»¥ç»Ÿä¸€è°ƒæ•´å’Œæµ‹è¯•

**å»ºè®®**:
```python
# åœ¨æ–‡ä»¶é¡¶éƒ¨å®šä¹‰å¸¸é‡
DEFAULT_SAMPLE_SIZE = 10000
PREDICTION_SAMPLE_SIZE = 5000
```

#### 6. ç¼ºå°‘ç±»åž‹æç¤º
**é—®é¢˜**:
- å¤§éƒ¨åˆ†å‡½æ•°ç¼ºå°‘ç±»åž‹æç¤ºï¼ˆType Hintsï¼‰
- å½±å“ä»£ç å¯è¯»æ€§å’Œ IDE æ”¯æŒ

**å»ºè®®**:
```python
from typing import Optional, Tuple, Dict, List

def prepare_features(
    train_df_filled: pd.DataFrame, 
    fill_missing: bool = True, 
    standardize: bool = True
) -> Tuple[pd.DataFrame, Optional[np.ndarray], List[str], Dict]:
    ...
```

---

### ðŸŸ¢ è½»å¾®é—®é¢˜

#### 7. æœªä½¿ç”¨çš„å¯¼å…¥
**ä½ç½®**: `app.py` ç¬¬ 9-10 è¡Œ

**é—®é¢˜**:
```python
import os
import sys
```

**åˆ†æž**:
- `os` æ¨¡å—åœ¨ä»£ç ä¸­ä¼¼ä¹Žæ²¡æœ‰è¢«ä½¿ç”¨
- `sys` åªåœ¨ç‰¹å®šåœ°æ–¹ä½¿ç”¨ï¼Œå¯ä»¥è€ƒè™‘å±€éƒ¨å¯¼å…¥

#### 8. é­”æ³•æ•°å­—
**ä½ç½®**: å¤šå¤„

**é—®é¢˜**:
- å¦‚ `0.5`, `0.2`, `70`, `50` ç­‰é˜ˆå€¼ç›´æŽ¥å†™åœ¨ä»£ç ä¸­
- ç¼ºå°‘æ³¨é‡Šè¯´æ˜Žè¿™äº›æ•°å­—çš„å«ä¹‰

**å»ºè®®**:
```python
# é£Žé™©é˜ˆå€¼å¸¸é‡
HIGH_RISK_THRESHOLD = 0.5
MEDIUM_RISK_THRESHOLD = 0.2
HIGH_MISSING_RATIO = 70  # é«˜ç¼ºå¤±çŽ‡é˜ˆå€¼ï¼ˆ%ï¼‰
```

#### 9. æ³¨é‡Šä¸å¤Ÿè¯¦ç»†
**é—®é¢˜**:
- ä¸€äº›å¤æ‚é€»è¾‘ç¼ºå°‘æ³¨é‡Š
- ç‰¹åˆ«æ˜¯ç‰¹å¾å·¥ç¨‹å’Œé¢„æµ‹æµç¨‹ä¸­çš„å…³é”®æ­¥éª¤

#### 10. requirements.txt ç‰ˆæœ¬èŒƒå›´
**ä½ç½®**: `requirements.txt`

**é—®é¢˜**:
- æ‰€æœ‰ä¾èµ–éƒ½ä½¿ç”¨äº† `>=` ç‰ˆæœ¬çº¦æŸ
- æ²¡æœ‰æŒ‡å®šä¸Šé™ç‰ˆæœ¬ï¼Œå¯èƒ½å¯¼è‡´æœªæ¥ç‰ˆæœ¬ä¸å…¼å®¹

**å»ºè®®**:
```txt
streamlit>=1.28.0,<2.0.0
pandas>=1.5.0,<3.0.0
# ç­‰ç­‰
```

---

## ðŸ“‹ ä»£ç è´¨é‡è¯„ä¼°

### æ•´ä½“è¯„åˆ†: 7.5/10

| ç»´åº¦ | è¯„åˆ† | è¯´æ˜Ž |
|------|------|------|
| åŠŸèƒ½å®Œæ•´æ€§ | 9/10 | åŠŸèƒ½é½å…¨ï¼Œè¦†ç›–äº†æ•°æ®åŠ è½½ã€é¢„å¤„ç†ã€åˆ†æžã€æ¨¡åž‹è®­ç»ƒå’Œè¯„ä¼° |
| ä»£ç ç»“æž„ | 8/10 | æ¨¡å—åŒ–è‰¯å¥½ï¼Œä½†å­˜åœ¨ä¸€äº›é‡å¤ä»£ç  |
| é”™è¯¯å¤„ç† | 7/10 | æœ‰é”™è¯¯å¤„ç†ï¼Œä½†éƒ¨åˆ†åœ°æ–¹ä½¿ç”¨è£¸éœ² except |
| æ€§èƒ½ä¼˜åŒ– | 8/10 | ä½¿ç”¨äº†ç¼“å­˜å’Œåˆ†å—è¯»å–ï¼Œä½†ä»æœ‰ä¼˜åŒ–ç©ºé—´ |
| å¯ç»´æŠ¤æ€§ | 7/10 | ä»£ç è¾ƒé•¿ï¼Œéƒ¨åˆ†é€»è¾‘å¤æ‚ï¼Œç¼ºå°‘ç±»åž‹æç¤º |
| æ–‡æ¡£ | 6/10 | README è¯¦ç»†ï¼Œä½†ä»£ç æ³¨é‡Šå¯ä»¥æ›´å®Œå–„ |

---

## ðŸ”§ ä¿®å¤å»ºè®®ä¼˜å…ˆçº§

### é«˜ä¼˜å…ˆçº§ï¼ˆå¿…é¡»ä¿®å¤ï¼‰
1. âœ… **ä¿®å¤æ¨¡å—å¯¼å…¥é”™è¯¯** (`model_training` â†’ `model_utils`)
2. âœ… **ä¿®å¤è·¯å¾„ä¾èµ–é—®é¢˜** (`BASE_DIR.parent` â†’ `BASE_DIR`)

### ä¸­ä¼˜å…ˆçº§ï¼ˆå»ºè®®ä¿®å¤ï¼‰
3. âš ï¸ **æ›¿æ¢è£¸éœ²çš„ except è¯­å¥**
4. âš ï¸ **æå–é‡å¤ä»£ç åˆ°å‡½æ•°**
5. âš ï¸ **æ·»åŠ é…ç½®å¸¸é‡**

### ä½Žä¼˜å…ˆçº§ï¼ˆå¯é€‰ä¼˜åŒ–ï¼‰
6. ðŸ’¡ **æ·»åŠ ç±»åž‹æç¤º**
7. ðŸ’¡ **ä¼˜åŒ–æœªä½¿ç”¨çš„å¯¼å…¥**
8. ðŸ’¡ **æ·»åŠ æ›´å¤šæ³¨é‡Š**
9. ðŸ’¡ **æ›´æ–° requirements.txt ç‰ˆæœ¬çº¦æŸ**

---

## ðŸ“ å…·ä½“ä¿®å¤ä»£ç ç¤ºä¾‹

### ä¿®å¤1: æ¨¡å—å¯¼å…¥
```python
# app.py ç¬¬ 448 è¡Œ
# ä¿®æ”¹å‰:
from model_training import prepare_features

# ä¿®æ”¹åŽ:
from model_utils import prepare_features
```

### ä¿®å¤2: è·¯å¾„ä¾èµ–
```python
# app.py ç¬¬ 127, 431 è¡Œ
# ä¿®æ”¹å‰:
sys.path.insert(0, str(BASE_DIR.parent))
from feature_engineering import apply_feature_engineering

# ä¿®æ”¹åŽ:
sys.path.insert(0, str(BASE_DIR))
from feature_engineering import apply_feature_engineering
```

### ä¿®å¤3: è£¸éœ² except
```python
# app.py ç¬¬ 509, 605 è¡Œ
# ä¿®æ”¹å‰:
except:
    pass

# ä¿®æ”¹åŽ:
except Exception:
    pass
```

---

## âœ… æ£€æŸ¥æ¸…å•

- [x] ä»£ç è¯­æ³•æ£€æŸ¥ï¼ˆæ— è¯­æ³•é”™è¯¯ï¼‰
- [x] å¯¼å…¥ä¾èµ–æ£€æŸ¥ï¼ˆå‘çŽ°å¯¼å…¥é”™è¯¯ï¼‰
- [x] è·¯å¾„å¤„ç†æ£€æŸ¥ï¼ˆå‘çŽ°è·¯å¾„é—®é¢˜ï¼‰
- [x] é”™è¯¯å¤„ç†æ£€æŸ¥ï¼ˆå‘çŽ°è£¸éœ² exceptï¼‰
- [x] ä»£ç é‡å¤æ£€æŸ¥ï¼ˆå‘çŽ°é‡å¤ä»£ç ï¼‰
- [x] æ€§èƒ½é—®é¢˜æ£€æŸ¥ï¼ˆåŸºæœ¬è‰¯å¥½ï¼‰
- [x] å®‰å…¨æ€§æ£€æŸ¥ï¼ˆæ— æ˜Žæ˜¾å®‰å…¨é—®é¢˜ï¼‰
- [x] æ–‡æ¡£å®Œæ•´æ€§æ£€æŸ¥ï¼ˆREADME å®Œæ•´ï¼‰

---

## ðŸ“Œ æ€»ç»“

WiDS é¡¹ç›®çš„ä»£ç æ•´ä½“è´¨é‡è‰¯å¥½ï¼ŒåŠŸèƒ½å®Œæ•´ï¼Œæ€§èƒ½ä¼˜åŒ–åˆ°ä½ã€‚ä¸»è¦é—®é¢˜é›†ä¸­åœ¨ï¼š

1. **æ¨¡å—å¯¼å…¥è·¯å¾„é”™è¯¯** - éœ€è¦ç«‹å³ä¿®å¤
2. **ä»£ç é‡å¤** - å»ºè®®é‡æž„
3. **é”™è¯¯å¤„ç†ä¸å¤Ÿè§„èŒƒ** - å»ºè®®æ”¹è¿›

ä¿®å¤è¿™äº›é—®é¢˜åŽï¼Œä»£ç è´¨é‡å°†è¿›ä¸€æ­¥æå‡ã€‚å»ºè®®ä¼˜å…ˆä¿®å¤é«˜ä¼˜å…ˆçº§é—®é¢˜ï¼Œç„¶åŽé€æ­¥ä¼˜åŒ–ä¸­ä½Žä¼˜å…ˆçº§é—®é¢˜ã€‚

---

## ðŸ” åŽç»­å»ºè®®

1. **æ·»åŠ å•å…ƒæµ‹è¯•**: ä¸ºå…³é”®å‡½æ•°æ·»åŠ æµ‹è¯•ç”¨ä¾‹
2. **ä»£ç æ ¼å¼åŒ–**: ä½¿ç”¨ `black` æˆ– `autopep8` ç»Ÿä¸€ä»£ç é£Žæ ¼
3. **ç±»åž‹æ£€æŸ¥**: ä½¿ç”¨ `mypy` è¿›è¡Œç±»åž‹æ£€æŸ¥
4. **ä»£ç å®¡æŸ¥**: å®šæœŸè¿›è¡Œä»£ç å®¡æŸ¥ï¼Œä¿æŒä»£ç è´¨é‡
5. **æ–‡æ¡£æ›´æ–°**: éšç€ä»£ç å˜æ›´åŠæ—¶æ›´æ–°æ–‡æ¡£
